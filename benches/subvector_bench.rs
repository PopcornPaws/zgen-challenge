#[macro_use]
extern crate bencher;

use bencher::Bencher;
use stuff::*;

const TEST_STR_SHORT: &str = "9012345678998765432ab88de";
const EXPECTED_SHORT: &str = "32ab88de";

const TEST_STR_MEDIUM: &str = "ab9012345678998765432ab88de99999999999999999999999\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x";
const EXPECTED_MEDIUM: &str = "32ab88de";

const TEST_STR_LONG: &str = "9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
ab9012345678998765432ab88de9999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x\
9999999999999999999999999999999999999999999999999x";
const EXPECTED_LONG: &str = "32ab88de";

fn slow_short_input(bench: &mut Bencher) {
    bench.iter(|| {
        assert_eq!(
            Some(EXPECTED_SHORT),
            identify_subvector_slow(TEST_STR_SHORT)
        );
    });
}

fn fast_short_input(bench: &mut Bencher) {
    bench.iter(|| {
        assert_eq!(
            Some(EXPECTED_SHORT),
            identify_subvector_fast(TEST_STR_SHORT)
        );
    });
}

fn slow_medium_input(bench: &mut Bencher) {
    bench.iter(|| {
        assert_eq!(
            Some(EXPECTED_MEDIUM),
            identify_subvector_slow(TEST_STR_MEDIUM)
        );
    });
}

fn fast_medium_input(bench: &mut Bencher) {
    bench.iter(|| {
        assert_eq!(
            Some(EXPECTED_MEDIUM),
            identify_subvector_fast(TEST_STR_MEDIUM)
        );
    });
}

fn slow_long_input(bench: &mut Bencher) {
    bench.iter(|| {
        assert_eq!(Some(EXPECTED_LONG), identify_subvector_slow(TEST_STR_LONG));
    });
}

fn fast_long_input(bench: &mut Bencher) {
    bench.iter(|| {
        assert_eq!(Some(EXPECTED_LONG), identify_subvector_fast(TEST_STR_LONG));
    });
}

benchmark_group!(
    benches,
    slow_short_input,
    fast_short_input,
    slow_medium_input,
    fast_medium_input,
    slow_long_input,
    fast_long_input
);
benchmark_main!(benches);
